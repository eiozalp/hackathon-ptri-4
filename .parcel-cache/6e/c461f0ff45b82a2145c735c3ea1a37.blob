!function(){let e;function s(s){if("complete"===s.status){const t=function(e){return(e=new URL(e).hostname.split(".")).length>2&&(e=e.slice(1)),e.join(".")}(s.url);if(console.log(t),console.log(`Tab change event. Current session: ${e}. New session: ${t}.`),e===t)return;!function(e){e&&chrome.storage.sync.get([e],(s=>{const t=s[e],n=t[t.length-1];n.end=(new Date).getTime(),n.duration=n.end-n.start,t[t.length-1]=n,chrome.storage.sync.set({[e]:t}),console.log(t)}))}(e),e=t;const n={url:t,start:(new Date).getTime(),end:null,duration:null};chrome.storage.sync.get(["keys"],(({keys:e})=>{e.includes(t)?chrome.storage.sync.get([t],(e=>{const s=e[t];s.push(n),chrome.storage.sync.set({[t]:s})})):(e.push(t),chrome.storage.sync.set({keys:e}),chrome.storage.sync.set({[t]:[n]}),chrome.storage.sync.get(["favicons"],(({favicons:e})=>{t in e||(e[t]=s.favIconUrl),chrome.storage.sync.set({favicons:e})})))}))}}chrome.runtime.onInstalled.addListener((()=>{chrome.storage.sync.set({keys:[]}),chrome.storage.sync.set({favicons:{}})})),chrome.runtime.onStartup.addListener((async()=>{chrome.storage.sync.get("keys",(e=>{e||chrome.storage.sync.set({keys:[]})})),chrome.storage.sync.get("favicons",(e=>{e||chrome.storage.sync.set({favicons:{}})}))})),chrome.tabs.onUpdated.addListener((async(e,t,n)=>{s(n)})),chrome.tabs.onActivated.addListener((async e=>{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});s(t)}))}();
//# sourceMappingURL=background.js.map
